<?xml version="1.0" encoding="UTF-8"?>
<!-- Created with Jaspersoft Studio version 6.6.0.final using JasperReports Library version 6.6.0  -->
<jasperReport xmlns="http://jasperreports.sourceforge.net/jasperreports" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" xsi:schemaLocation="http://jasperreports.sourceforge.net/jasperreports http://jasperreports.sourceforge.net/xsd/jasperreport.xsd" name="asm_by_tse_report" pageWidth="842" pageHeight="595" orientation="Landscape" columnWidth="802" leftMargin="20" rightMargin="20" topMargin="20" bottomMargin="20" isFloatColumnFooter="true" whenResourceMissingType="Key" isIgnorePagination="true" uuid="908eb0cf-ba76-4a3d-97b6-7e0de5787f74">
	<property name="com.jaspersoft.studio.data.defaultdataadapter" value="see-kpi-pmtl"/>
	<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
	<property name="net.sf.jasperreports.print.create.bookmarks" value="false"/>
	<style name="Crosstab_CH" mode="Opaque" backcolor="#F0F8FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CG" mode="Opaque" backcolor="#BFE1FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CT" mode="Opaque" backcolor="#3399FF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab_CD" mode="Opaque" backcolor="#FFFFFF">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<style name="Crosstab 1_CT" mode="Opaque" backcolor="#005FB3">
		<box>
			<pen lineWidth="0.5" lineColor="#000000"/>
			<topPen lineWidth="0.5" lineColor="#000000"/>
			<leftPen lineWidth="0.5" lineColor="#000000"/>
			<bottomPen lineWidth="0.5" lineColor="#000000"/>
			<rightPen lineWidth="0.5" lineColor="#000000"/>
		</box>
	</style>
	<subDataset name="test " uuid="291d53dc-c8a9-4047-ae34-f4ae198a65c7">
		<property name="com.jaspersoft.studio.data.defaultdataadapter" value="see-kpi-pmtl"/>
		<property name="com.jaspersoft.studio.data.sql.tables" value=""/>
		<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w1" value="481"/>
		<property name="com.jaspersoft.studio.property.dataset.dialog.DatasetDialog.sash.w2" value="505"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w1" value="143"/>
		<property name="com.jaspersoft.studio.data.sql.SQLQueryDesigner.sash.w2" value="850"/>
		<parameter name="param_date_start" class="java.lang.String"/>
		<parameter name="param_date_end" class="java.lang.String"/>
		<parameter name="param_questionaire_type" class="java.lang.String"/>
		<parameter name="param_employee" class="java.lang.String"/>
		<parameter name="param_assessor" class="java.lang.String"/>
		<parameter name="param_job_function" class="java.lang.String"/>
		<queryString>
			<![CDATA[SELECT qnt.questionaire_type_id
, qnt.questionaire_type
, qdh.assessor_id
, po.position_code AS position_assor
, CONCAT(emp.emp_first_name,' ',emp.emp_last_name) AS name_assessor
, qdh.emp_snapshot_id
, po_tse.position_code AS position_employee
, CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name) AS name_employee
, qdh.questionaire_date
, q.parent_question_id
, pq.question_name
, rt.num_cus
, rt.num_from
, rt.know

, COALESCE(
		CASE WHEN qn.pass_score_type = "percentage"
		THEN IFNULL(ROUND((qdh.total_score*100)/qdh.full_score, 2), 0)
		ELSE p_score_total.p_score
		END
		,0) AS percent_score
		
-- , p_score_total.p_score AS percent_score
-- , IFNULL(ROUND((qdh.total_score*100)/qdh.full_score, 2), 0) percent_score
, COALESCE(
		CASE WHEN qn.pass_score_type = "percentage"
		THEN ROUND((SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.score END)*100)
		/SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.full_score END),2)
		ELSE p_score.p_score
		END
		,0) AS percent
, total.percent AS percent_by_total
, result.num_from AS sum_num_from
, result.num_cus AS sum_num_cus
, result.know AS sum_know
, emp.job_function_id 
, res.num_from  as n_form
, res.num_cus as n_cus
, res.know as n_know
, per.percent_all
, qn.pass_score_type

FROM questionaire_data_header qdh
LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
-- INNER JOIN customer cus ON qdd.customer_id = cus.customer_id
LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id
INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id
INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id
LEFT JOIN question q ON qdd.question_id = q.question_id
LEFT JOIN question pq ON q.parent_question_id = pq.question_id
INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id
LEFT JOIN position po ON emp.position_id = po.position_id
INNER JOIN employee_snapshot emp_tse ON qdh.emp_snapshot_id = emp_tse.emp_snapshot_id
INNER JOIN job_function jb ON jb.job_function_id = emp_tse.job_function_id
LEFT JOIN position po_tse ON emp_tse.position_id = po_tse.position_id
LEFT JOIN (
 SELECT 
	 qnt.questionaire_type_id
 , qnt.questionaire_type
 , qdh.assessor_id
 , po.position_code AS position_assor
 , CONCAT(emp.emp_first_name,' ',emp.emp_last_name) AS name_assessor
 , qdh.emp_snapshot_id
 , po_tse.position_code AS position_employee
 , CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name) AS name_employee
 , q.parent_question_id
 , pq.question_name
 , COUNT(distinct qdh.questionaire_id) AS num_from
 , COUNT(distinct qdd.customer_id) AS num_cus
 , (CASE WHEN qdh.data_stage_id = 4 THEN 1 ELSE 0 END) AS know
 , COALESCE(
		CASE WHEN qn.pass_score_type = "percentage"
		THEN ROUND((SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.score END)*100)
		/SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.full_score END),2)
		ELSE 
				total_p_score.p_score
		END
		,0) AS percent
 FROM questionaire_data_header qdh
 LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
 LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id
 INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id
 INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id
 LEFT JOIN question q ON qdd.question_id = q.question_id
 LEFT JOIN question pq ON q.parent_question_id = pq.question_id
 INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id
 LEFT JOIN position po ON emp.position_id = po.position_id
 INNER JOIN employee_snapshot emp_tse ON qdh.emp_snapshot_id = emp_tse.emp_snapshot_id
 LEFT JOIN position po_tse ON emp_tse.position_id = po_tse.position_id
 LEFT JOIN (
SELECT sscore.parent_question_id,sscore.questionaire_date, SUM(sscore.sum_score) as s_score, SUM(sscore.full_score)as s_fullscore ,ROUND(SUM(sscore.sum_score)*100/SUM(sscore.full_score),2) AS p_score , sscore.emp_snapshot_id
FROM(
		SELECT ss.parent_question_id
		,ss.question_name
		,SUM(SS.cus)
		, (CASE WHEN SS.is_cust_search=0 THEN sum(ss.full_score) ELSE MAX(SS.full_score) END ) as full_score
		, (CASE WHEN SS.is_cust_search=0 THEN SUM(ss.sum_score) ELSE (CASE WHEN SUM(SS.cus) = 0 THEN 0 ELSE ROUND(SUM(ss.sum_score)/SUM(SS.cus),2) END)END) as sum_score
		, SS.is_cust_search
		, SS.questionaire_date
		, ss.emp_snapshot_id
		FROM(
			SELECT 	q.parent_question_id
			, q.question_name
			, SUM(qdd.score) sum_score
			, (CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE COUNT(qdd.customer_id) END) cus 
			, max(CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE qdd.full_score END)as full_score
			, qs.is_cust_search
			, qdh.questionaire_date
			, qdh.emp_snapshot_id
			, qdh.data_header_id
			FROM questionaire_data_header qdh
			INNER JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
			INNER JOIN questionaire_section qs ON qs.section_id = qdd.section_id
			INNER JOIN questionaire qn ON qn.questionaire_id = qdh.questionaire_id
			INNER JOIN questionaire_type qnt ON qnt.questionaire_type_id = qn.questionaire_type_id
			INNER JOIN question q ON q.question_id = qdd.question_id
			LEFT JOIN customer c ON c.customer_id = qdd.customer_id
			WHERE q.answer_type_id != 7
			AND qdh.data_stage_id >=3
			AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
			AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
			AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
			AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
			GROUP BY q.question_id , qdd.customer_id,qdh.questionaire_date,qdh.emp_snapshot_id,qdh.data_header_id
		)SS
		GROUP BY SS.parent_question_id , ss.question_name ,ss.questionaire_date ,SS.emp_snapshot_id,SS.data_header_id
) sscore
GROUP BY sscore.parent_question_id  , sscore.emp_snapshot_id
)total_p_score on q.parent_question_id = total_p_score.parent_question_id
AND  qdh.emp_snapshot_id = total_p_score.emp_snapshot_id
WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
GROUP BY qnt.questionaire_type_id
 , qnt.questionaire_type
 , qdh.assessor_id
 , po.position_code
 , CONCAT(emp.emp_first_name,' ',emp.emp_last_name)
 , qdh.emp_snapshot_id
 , po_tse.position_code
 , CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name)
 , q.parent_question_id
 , pq.question_name
) total ON total.assessor_id = qdh.assessor_id
AND total.emp_snapshot_id = qdh.emp_snapshot_id
AND total.parent_question_id = q.parent_question_id
AND total.questionaire_type_id = qnt.questionaire_type_id
LEFT JOIN (
 SELECT rr.questionaire_type_id
 , rr.questionaire_type
 , rr.assessor_id
 , rr.emp_snapshot_id
 , rr.position_code
 , rr.questionaire_date
 , SUM(rr.num_from) as num_from
 , SUM(rr.num_cus) as num_cus
 , SUM(rr.know) as know
 FROM(
  SELECT qnt.questionaire_type_id
   , qnt.questionaire_type
   , qdh.data_header_id
   , qdh.assessor_id
   , qdh.emp_snapshot_id
   , po_tse.position_code
   , qdh.questionaire_date
   , COUNT(distinct qdh.questionaire_id) AS num_from
   , COUNT(distinct qdd.customer_id) AS num_cus
   , (CASE WHEN qdh.data_stage_id = 4 THEN 1 ELSE 0 END) AS know
 FROM questionaire_data_header qdh
   LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
   INNER JOIN customer cus ON qdd.customer_id = cus.customer_id
   LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id
   INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id
   INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id
   LEFT JOIN question q ON qdd.question_id = q.question_id
   LEFT JOIN question pq ON q.parent_question_id = pq.question_id
   INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id
   LEFT JOIN position po ON emp.position_id = po.position_id
   INNER JOIN employee_snapshot emp_tse ON qdh.emp_snapshot_id = emp_tse.emp_snapshot_id
   LEFT JOIN position po_tse ON emp_tse.position_id = po_tse.position_id
WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
 group by qnt.questionaire_type_id
   , qnt.questionaire_type
   , qdh.data_header_id
   , qdh.assessor_id
   , po.position_code
   , qdh.emp_snapshot_id
   , po_tse.position_code
   , qdh.questionaire_date
 ) rr
 GROUP BY rr.questionaire_type_id
 , rr.questionaire_type
 , rr.assessor_id
 , rr.emp_snapshot_id
 , rr.position_code
 , rr.questionaire_date
) rt ON rt.questionaire_type_id = qnt.questionaire_type_id
AND rt.assessor_id = qdh.assessor_id
AND rt.emp_snapshot_id = qdh.emp_snapshot_id
AND rt.questionaire_date = qdh.questionaire_date
LEFT JOIN (
 SELECT re.questionaire_type_id
 , re.assessor_id
 , re.emp_snapshot_id
 , re.parent_question_id
 , SUM(re.num_from) AS num_from
 , SUM(re.num_cus) AS num_cus
 , SUM(re.know) AS know
 FROM(
 SELECT qnt.questionaire_type_id
  , qnt.questionaire_type
  , qdh.data_header_id
  , qdh.assessor_id
  , po.position_code AS position_assor
  , CONCAT(emp.emp_first_name,' ',emp.emp_last_name) AS name_assessor
  , qdh.emp_snapshot_id
  , po_tse.position_code AS position_employee
  , CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name) AS name_employee
  , qdh.questionaire_date
  , q.parent_question_id
  , pq.question_name
  , COUNT(distinct qdh.questionaire_id) AS num_from
  , COUNT(distinct qdd.customer_id) AS num_cus
  , (CASE WHEN qdh.data_stage_id = 4 THEN 1 ELSE 0 END) AS know
  , COALESCE(ROUND((SUM(qdd.score)*100)/SUM(qdd.full_score),2),0) AS percent
  FROM questionaire_data_header qdh
  LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
  -- INNER JOIN customer cus ON qdd.customer_id = cus.customer_id
  LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id
  INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id
  INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id
  LEFT JOIN question q ON qdd.question_id = q.question_id
  LEFT JOIN question pq ON q.parent_question_id = pq.question_id
  INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id
  LEFT JOIN position po ON emp.position_id = po.position_id
  INNER JOIN employee_snapshot emp_tse ON qdh.emp_snapshot_id = emp_tse.emp_snapshot_id
  LEFT JOIN position po_tse ON emp_tse.position_id = po_tse.position_id
WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
			 GROUP BY qnt.questionaire_type_id
  , qnt.questionaire_type
  , qdh.data_header_id
  , qdh.assessor_id
  , po.position_code
  , CONCAT(emp.emp_first_name,' ',emp.emp_last_name)
  , qdh.emp_snapshot_id
  , po_tse.position_code
  , CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name)
  , qdh.questionaire_date
  , q.parent_question_id
  , pq.question_name
 ) re
 GROUP BY re.questionaire_type_id
 , re.assessor_id
 , re.emp_snapshot_id
 , re.parent_question_id
) result ON result.questionaire_type_id = qnt.questionaire_type_id
AND result.parent_question_id = q.parent_question_id
AND result.assessor_id = qdh.assessor_id
AND result.emp_snapshot_id = qdh.emp_snapshot_id
LEFT JOIN ( 
 SELECT num.questionaire_type_id 
 , num.assessor_id 
 , num.parent_question_id 
 , SUM(num.num_from) AS num_from 
 , SUM(num.num_cus) AS num_cus 
 , SUM(num.know) AS know 
 FROM ( 
  SELECT qnt.questionaire_type_id 
  , qnt.questionaire_type 
  , qdh.assessor_id 
  , qdh.emp_snapshot_id 
  , qdh.questionaire_date 
  , q.parent_question_id 
  , pq.question_name 
  , COUNT(distinct qdh.questionaire_id) AS num_from 
  , COUNT(distinct qdd.customer_id) AS num_cus 
  , (CASE WHEN qdh.data_stage_id = 4 THEN 1 ELSE 0 END) AS know 
  FROM questionaire_data_header qdh 
  LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id 
  -- INNER JOIN customer cus ON qdd.customer_id = cus.customer_id 
  LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id 
  INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id 
  INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id 
  LEFT JOIN question q ON qdd.question_id = q.question_id 
  LEFT JOIN question pq ON q.parent_question_id = pq.question_id 
  INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id 
  LEFT JOIN position po ON emp.position_id = po.position_id 
  INNER JOIN employee_snapshot emp_tse ON qdh.emp_snapshot_id = emp_tse.emp_snapshot_id 
 LEFT JOIN position po_tse ON emp_tse.position_id = po_tse.position_id 
 WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
 GROUP BY qnt.questionaire_type_id 
  , qdh.data_header_id
  , qnt.questionaire_type 
  , qdh.assessor_id 
  , qdh.emp_snapshot_id 
  , qdh.questionaire_date 
  , q.parent_question_id 
  , pq.question_name 
 ) num 
 GROUP BY num.questionaire_type_id 
 , num.assessor_id 
 , num.parent_question_id 
) res ON res.questionaire_type_id = qnt.questionaire_type_id 
AND res.parent_question_id = q.parent_question_id
AND res.assessor_id = qdh.assessor_id
INNER JOIN (
SELECT qnt.questionaire_type_id 
, qnt.questionaire_type 
, qdh.assessor_id 
, q.parent_question_id
, COALESCE(
		CASE WHEN qn.pass_score_type = "percentage"
		THEN ROUND((SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.score END)*100)
		/SUM(CASE WHEN qdd.is_not_applicable = 1 THEN 0 ELSE qdd.full_score END),2)
		ELSE 
		all_p_score.p_score
		END
		,0) AS percent_all
FROM questionaire_data_header qdh 
LEFT JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id 
-- INNER JOIN customer cus ON qdd.customer_id = cus.customer_id 
LEFT JOIN questionaire_section qs ON qs.section_id = qdd.section_id 
INNER JOIN questionaire qn ON qdh.questionaire_id = qn.questionaire_id 
INNER JOIN questionaire_type qnt ON qn.questionaire_type_id = qnt.questionaire_type_id 
LEFT JOIN question q ON qdd.question_id = q.question_id 
LEFT JOIN question pq ON q.parent_question_id = pq.question_id 
INNER JOIN employee_snapshot emp ON qdh.assessor_id = emp.emp_snapshot_id 
LEFT JOIN position po ON emp.position_id = po.position_id 
 LEFT JOIN (
SELECT sscore.parent_question_id,sscore.questionaire_date, SUM(sscore.sum_score) as s_score, SUM(sscore.full_score)as s_fullscore ,ROUND(SUM(sscore.sum_score)*100/SUM(sscore.full_score),2) AS p_score
, sscore.assessor_id
FROM(
		SELECT ss.parent_question_id
		,ss.question_name
		,SUM(SS.cus)
		, (CASE WHEN SS.is_cust_search=0 THEN sum(ss.full_score) ELSE MAX(SS.full_score) END ) as full_score
		, (CASE WHEN SS.is_cust_search=0 THEN SUM(ss.sum_score) ELSE (CASE WHEN SUM(SS.cus) = 0 THEN 0 ELSE ROUND(SUM(ss.sum_score)/SUM(SS.cus),2) END)END) as sum_score
		, SS.is_cust_search
		, SS.questionaire_date
		, ss.emp_snapshot_id
		, ss.assessor_id
		, SS.data_header_id
		FROM(
			SELECT 	q.parent_question_id
			, q.question_name
			, SUM(qdd.score) sum_score
			, (CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE COUNT(qdd.customer_id) END) cus 
			, max(CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE qdd.full_score END)as full_score
			, qs.is_cust_search
			, qdh.questionaire_date
			, qdh.emp_snapshot_id
			, qdh.assessor_id
			, qdh.data_header_id
			FROM questionaire_data_header qdh
			INNER JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
			INNER JOIN questionaire_section qs ON qs.section_id = qdd.section_id
			INNER JOIN questionaire qn ON qn.questionaire_id = qdh.questionaire_id
			INNER JOIN questionaire_type qnt ON qnt.questionaire_type_id = qn.questionaire_type_id
			INNER JOIN question q ON q.question_id = qdd.question_id
			LEFT JOIN customer c ON c.customer_id = qdd.customer_id
			WHERE q.answer_type_id != 7
			AND qdh.data_stage_id >=3
			AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
			AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
			AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
			AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
			GROUP BY q.question_id , qdd.customer_id,qdh.questionaire_date,qdh.emp_snapshot_id,qdh.data_header_id
		)SS
		GROUP BY SS.parent_question_id , ss.question_name  ,ss.questionaire_date  ,SS.emp_snapshot_id,SS.assessor_id ,SS.data_header_id
) sscore
GROUP BY sscore.parent_question_id   , sscore.assessor_id
)all_p_score on q.parent_question_id = all_p_score.parent_question_id
AND qdh.assessor_id = all_p_score.assessor_id
WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
GROUP BY qnt.questionaire_type_id 
, qnt.questionaire_type 
, qdh.assessor_id 
, po.position_code 
, CONCAT(emp.emp_first_name,' ',emp.emp_last_name) 
, q.parent_question_id 
, pq.question_name  
ORDER BY qnt.questionaire_type_id ASC, q.parent_question_id ASC, qdh.assessor_id ASC
) as per ON per.questionaire_type_id = qnt.questionaire_type_id 
AND per.parent_question_id = q.parent_question_id
AND per.assessor_id = qdh.assessor_id 
LEFT JOIN(
SELECT sscore.parent_question_id,sscore.questionaire_date, SUM(sscore.sum_score) as s_score, SUM(sscore.full_score)as s_fullscore ,ROUND(SUM(sscore.sum_score)*100/SUM(sscore.full_score),2) AS p_score , sscore.emp_snapshot_id
FROM(
		SELECT ss.parent_question_id
		,ss.question_name
		,SUM(SS.cus)
		, (CASE WHEN SS.is_cust_search=0 THEN sum(ss.full_score) ELSE MAX(SS.full_score) END ) as full_score
		, (CASE WHEN SS.is_cust_search=0 THEN SUM(ss.sum_score) ELSE (CASE WHEN SUM(SS.cus) = 0 THEN 0 ELSE ROUND(SUM(ss.sum_score)/SUM(SS.cus),2) END)END) as sum_score
		, SS.is_cust_search
		, SS.questionaire_date
		, ss.emp_snapshot_id
		FROM(
			SELECT 	q.parent_question_id
			, q.question_name
			, SUM(qdd.score) sum_score
			, (CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE COUNT(qdd.customer_id) END) cus 
			, max(CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE qdd.full_score END)as full_score
			, qs.is_cust_search
			, qdh.questionaire_date
			, qdh.emp_snapshot_id
			, qdh.data_header_id
			FROM questionaire_data_header qdh
			INNER JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
			INNER JOIN questionaire_section qs ON qs.section_id = qdd.section_id
			INNER JOIN questionaire qn ON qn.questionaire_id = qdh.questionaire_id
			INNER JOIN questionaire_type qnt ON qnt.questionaire_type_id = qn.questionaire_type_id
			INNER JOIN question q ON q.question_id = qdd.question_id
			LEFT JOIN customer c ON c.customer_id = qdd.customer_id
			WHERE q.answer_type_id != 7
			AND qdh.data_stage_id >=3
			AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
			AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
			AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
			AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
			GROUP BY q.question_id , qdd.customer_id,qdh.questionaire_date,qdh.emp_snapshot_id,qdh.data_header_id
		)SS
		GROUP BY SS.parent_question_id , ss.question_name ,ss.questionaire_date ,SS.emp_snapshot_id,SS.data_header_id
) sscore
GROUP BY sscore.parent_question_id  , sscore.emp_snapshot_id ,sscore.questionaire_date
) p_score ON q.parent_question_id = p_score.parent_question_id
AND qdh.questionaire_date = p_score.questionaire_date
AND qdh.emp_snapshot_id = p_score.emp_snapshot_id
LEFT JOIN(
SELECT sscore.questionaire_date, SUM(sscore.sum_score) as s_score, SUM(sscore.full_score)as s_fullscore ,ROUND(SUM(sscore.sum_score)*100/SUM(sscore.full_score),2) AS p_score , sscore.emp_snapshot_id
FROM(
		SELECT ss.parent_question_id
		,ss.question_name
		,SUM(SS.cus)
		, (CASE WHEN SS.is_cust_search=0 THEN sum(ss.full_score) ELSE MAX(SS.full_score) END ) as full_score
		, (CASE WHEN SS.is_cust_search=0 THEN SUM(ss.sum_score) ELSE (CASE WHEN SUM(SS.cus) = 0 THEN 0 ELSE ROUND(SUM(ss.sum_score)/SUM(SS.cus),2) END)END) as sum_score
		, SS.is_cust_search
		, SS.questionaire_date
		, ss.emp_snapshot_id
		FROM(
			SELECT 	q.parent_question_id
			, q.question_name
			, SUM(qdd.score) sum_score
			, (CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE COUNT(qdd.customer_id) END) cus 
			, max(CASE WHEN qdd.is_not_applicable= 1 THEN 0 ELSE qdd.full_score END)as full_score
			, qs.is_cust_search
			, qdh.questionaire_date
			, qdh.emp_snapshot_id
			, qdh.data_header_id
			FROM questionaire_data_header qdh
			INNER JOIN questionaire_data_detail qdd ON qdd.data_header_id = qdh.data_header_id
			INNER JOIN questionaire_section qs ON qs.section_id = qdd.section_id
			INNER JOIN questionaire qn ON qn.questionaire_id = qdh.questionaire_id
			INNER JOIN questionaire_type qnt ON qnt.questionaire_type_id = qn.questionaire_type_id
			INNER JOIN question q ON q.question_id = qdd.question_id
			LEFT JOIN customer c ON c.customer_id = qdd.customer_id
			WHERE q.answer_type_id != 7
			AND qdh.data_stage_id >=3
			AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
			AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
			AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
			AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
			GROUP BY q.question_id , qdd.customer_id,qdh.questionaire_date,qdh.emp_snapshot_id,qdh.data_header_id
		)SS
		GROUP BY SS.parent_question_id , ss.question_name ,ss.questionaire_date ,SS.emp_snapshot_id,SS.data_header_id
) sscore
GROUP BY sscore.emp_snapshot_id ,sscore.questionaire_date
) p_score_total ON qdh.questionaire_date = p_score_total.questionaire_date
AND qdh.emp_snapshot_id = p_score_total.emp_snapshot_id
WHERE q.answer_type_id != 7
AND qdh.data_stage_id >=3
AND qdh.questionaire_date between STR_TO_DATE(  $P{param_date_start}     , "%d/%m/%Y") and STR_TO_DATE(  $P{param_date_end}    , "%d/%m/%Y")
AND (qdh.assessor_id =    $P{param_assessor}   OR '' =   $P{param_assessor}    OR  ISNULL(  $P{param_assessor}    ) = 1 )  
AND (qdh.emp_snapshot_id in( $P!{param_employee} ) OR   '999999999' = $P{param_employee}   )
AND (qnt.questionaire_type_id = $P{param_questionaire_type}      OR '' =   $P{param_questionaire_type}      OR  ISNULL(  $P{param_questionaire_type}      ) = 1 )
AND (jb.job_function_id  = $P{param_job_function}    OR '' =   $P{param_job_function}   OR  ISNULL(   $P{param_job_function}   ) = 1 )
GROUP BY qnt.questionaire_type_id
, qdh.questionaire_date
, qdh.data_header_id
, qnt.questionaire_type
, qdh.assessor_id
, po.position_code
, CONCAT(emp.emp_first_name,' ',emp.emp_last_name)
, qdh.emp_snapshot_id
, po_tse.position_code
, CONCAT(emp_tse.emp_first_name,' ',emp_tse.emp_last_name)
, qdh.questionaire_date
, q.parent_question_id
, pq.question_name
ORDER BY emp.job_function_id ASC, qnt.questionaire_type_id ASC, qdh.emp_snapshot_id ASC, qdh.questionaire_date ASC, q.parent_question_id ASC]]>
		</queryString>
		<field name="questionaire_type_id" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.label" value="questionaire_type_id"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire_type"/>
		</field>
		<field name="questionaire_type" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="questionaire_type"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire_type"/>
		</field>
		<field name="assessor_id" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.label" value="assessor_id"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire_data_header"/>
		</field>
		<field name="position_assor" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="position_assor"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="position"/>
		</field>
		<field name="name_assessor" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="name_assessor"/>
		</field>
		<field name="emp_snapshot_id" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.label" value="emp_snapshot_id"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire_data_header"/>
		</field>
		<field name="position_employee" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="position_employee"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="position"/>
		</field>
		<field name="name_employee" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="name_employee"/>
		</field>
		<field name="questionaire_date" class="java.sql.Date">
			<property name="com.jaspersoft.studio.field.label" value="questionaire_date"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire_data_header"/>
		</field>
		<field name="parent_question_id" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.label" value="parent_question_id"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="question"/>
		</field>
		<field name="question_name" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="question_name"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="question"/>
		</field>
		<field name="num_cus" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="num_cus"/>
		</field>
		<field name="num_from" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="num_from"/>
		</field>
		<field name="know" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="know"/>
		</field>
		<field name="percent_score" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="percent_score"/>
		</field>
		<field name="percent" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="percent"/>
		</field>
		<field name="percent_by_total" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="percent_by_total"/>
		</field>
		<field name="sum_num_from" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="sum_num_from"/>
		</field>
		<field name="sum_num_cus" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="sum_num_cus"/>
		</field>
		<field name="sum_know" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="sum_know"/>
		</field>
		<field name="job_function_id" class="java.lang.Integer">
			<property name="com.jaspersoft.studio.field.label" value="job_function_id"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="employee_snapshot"/>
		</field>
		<field name="n_form" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="n_form"/>
		</field>
		<field name="n_cus" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="n_cus"/>
		</field>
		<field name="n_know" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="n_know"/>
		</field>
		<field name="percent_all" class="java.math.BigDecimal">
			<property name="com.jaspersoft.studio.field.label" value="percent_all"/>
		</field>
		<field name="pass_score_type" class="java.lang.String">
			<property name="com.jaspersoft.studio.field.label" value="pass_score_type"/>
			<property name="com.jaspersoft.studio.field.tree.path" value="questionaire"/>
		</field>
	</subDataset>
	<parameter name="param_date_start" class="java.lang.String"/>
	<parameter name="param_date_end" class="java.lang.String"/>
	<parameter name="param_questionaire_type" class="java.lang.String"/>
	<parameter name="param_employee" class="java.lang.String"/>
	<parameter name="param_assessor" class="java.lang.String"/>
	<parameter name="param_data_header_id" class="java.lang.String"/>
	<parameter name="param_questionaire_date" class="java.lang.String"/>
	<parameter name="param_user" class="java.lang.String"/>
	<parameter name="param_job_function" class="java.lang.String"/>
	<queryString>
		<![CDATA[SELECT 1]]>
	</queryString>
	<field name="1" class="java.lang.Long">
		<property name="com.jaspersoft.studio.field.label" value="1"/>
	</field>
	<background>
		<band splitType="Stretch"/>
	</background>
	<columnHeader>
		<band height="279">
			<staticText>
				<reportElement key="" mode="Transparent" x="0" y="0" width="800" height="30" isRemoveLineWhenBlank="true" backcolor="rgba(196, 61, 59, 0.0)" uuid="29339155-3814-4ca8-a885-4d0ace43c37a"/>
				<textElement verticalAlignment="Middle">
					<font fontName="BrowalliaUPC" size="24" isBold="true"/>
					<paragraph leftIndent="5"/>
				</textElement>
				<text><![CDATA[ASM by TSE Report]]></text>
			</staticText>
			<crosstab ignoreWidth="true">
				<reportElement key="" isPrintRepeatedValues="false" x="0" y="50" width="800" height="229" uuid="e8843584-a1e6-4033-bfe0-45afe8f7352f">
					<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.VerticalRowLayout"/>
					<property name="com.jaspersoft.studio.crosstab.style.header" value="Crosstab_CH"/>
					<property name="com.jaspersoft.studio.crosstab.style.group" value="Crosstab_CG"/>
					<property name="com.jaspersoft.studio.crosstab.style.total" value="Crosstab_CT"/>
					<property name="com.jaspersoft.studio.crosstab.style.detail" value="Crosstab_CD"/>
					<property name="net.sf.jasperreports.export.headertoolbar.table.name" value=""/>
				</reportElement>
				<crosstabDataset>
					<dataset>
						<datasetRun subDataset="test " uuid="9dcbbd3a-19bf-410e-b0e8-bb77ce5a15ff">
							<datasetParameter name="param_assessor">
								<datasetParameterExpression><![CDATA[$P{param_assessor}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="param_date_end">
								<datasetParameterExpression><![CDATA[$P{param_date_end}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="param_date_start">
								<datasetParameterExpression><![CDATA[$P{param_date_start}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="param_employee">
								<datasetParameterExpression><![CDATA[$P{param_employee}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="param_questionaire_type">
								<datasetParameterExpression><![CDATA[$P{param_questionaire_type}]]></datasetParameterExpression>
							</datasetParameter>
							<datasetParameter name="param_job_function">
								<datasetParameterExpression><![CDATA[$P{param_job_function}]]></datasetParameterExpression>
							</datasetParameter>
							<connectionExpression><![CDATA[$P{REPORT_CONNECTION}]]></connectionExpression>
						</datasetRun>
					</dataset>
				</crosstabDataset>
				<crosstabHeaderCell>
					<cellContents mode="Opaque" style="Crosstab_CD">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
						<staticText>
							<reportElement stretchType="RelativeToTallestObject" mode="Opaque" x="0" y="0" width="252" height="170" backcolor="#B9FAEF" uuid="6c99e138-5942-4b47-b6b6-cb7746365bfe"/>
							<text><![CDATA[]]></text>
						</staticText>
						<staticText>
							<reportElement stretchType="RelativeToTallestObject" mode="Opaque" x="252" y="0" width="98" height="170" backcolor="#B9FAEF" uuid="88319e22-3457-423e-a42c-e51bb29ff5b4"/>
							<box bottomPadding="6">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Center" verticalAlignment="Bottom">
								<font fontName="BrowalliaUPC" size="14" isBold="true"/>
							</textElement>
							<text><![CDATA[วันที่ประเมิน]]></text>
						</staticText>
					</cellContents>
				</crosstabHeaderCell>
				<rowGroup name="assessor_id" width="0" totalPosition="End">
					<bucket class="java.lang.Integer">
						<bucketExpression><![CDATA[$F{assessor_id}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CT"/>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="job_function_id" width="0" totalPosition="End">
					<bucket class="java.lang.Integer">
						<bucketExpression><![CDATA[$F{job_function_id}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<textField>
								<reportElement x="0" y="0" width="0" height="60" uuid="3f510c81-1a93-4e6d-a8fe-41a0b0824126"/>
								<textFieldExpression><![CDATA[$V{job_function_id}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CG">
							<staticText>
								<reportElement x="0" y="0" width="350" height="0" uuid="221c725a-391d-47fc-a83a-d0202b2c32ff"/>
								<text><![CDATA[Total job_function_id]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="position_employee" width="252" totalPosition="Start">
					<bucket class="java.lang.String">
						<bucketExpression><![CDATA[$F{position_employee}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="70" height="40" uuid="446b275b-d336-40fc-b0cf-dd3d424923e3"/>
								<box leftPadding="3"/>
								<textElement>
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{position_employee}]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="70" y="0" width="182" height="40" uuid="5ca3b2fb-5a60-413a-9306-116e63a39ace"/>
								<box leftPadding="3"/>
								<textElement>
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{name_employee}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CT">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField>
								<reportElement x="252" y="0" width="98" height="20" uuid="849c48bb-708f-464f-ae8e-0aa7b9810857"/>
								<textElement>
									<font fontName="BrowalliaUPC"/>
								</textElement>
								<textFieldExpression><![CDATA[""]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="1" y="0" width="69" height="20" uuid="98651d63-763a-4a6e-a308-0a7a28736b35"/>
								<box leftPadding="3"/>
								<textElement>
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{position_assor}]]></textFieldExpression>
							</textField>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="70" y="0" width="182" height="20" uuid="ec77e51b-83cd-4162-a996-30adb4b95247"/>
								<box leftPadding="3"/>
								<textElement>
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{name_assessor}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<rowGroup name="questionaire_date" width="98" totalPosition="Start">
					<bucket class="java.sql.Date">
						<bucketExpression><![CDATA[$F{questionaire_date}]]></bucketExpression>
					</bucket>
					<crosstabRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<textField pattern="d/M/yyyy">
								<reportElement x="0" y="0" width="98" height="20" uuid="983107cd-b59e-40c4-a134-294600bd5c7d"/>
								<box leftPadding="3"/>
								<textElement textAlignment="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{questionaire_date}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabRowHeader>
					<crosstabTotalRowHeader>
						<cellContents mode="Opaque" style="Crosstab_CG">
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="98" height="20" uuid="164294c3-55ce-4c62-a518-32e46b9aacc8"/>
								<box leftPadding="3"/>
								<textElement>
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA["Total  "+$V{position_employee}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabTotalRowHeader>
				</rowGroup>
				<columnGroup name="questionaire_type_id" height="30" totalPosition="End">
					<bucket class="java.lang.Long">
						<bucketExpression><![CDATA[$F{questionaire_type_id}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents mode="Opaque" style="Crosstab 1_CT">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField>
								<reportElement mode="Opaque" x="0" y="0" width="180" height="30" forecolor="#FFFFFF" backcolor="#005FB3" uuid="42605c7e-17a1-4dfb-91a6-99e7aec8e546"/>
								<box leftPadding="5"/>
								<textElement textAlignment="Left" verticalAlignment="Middle">
									<font fontName="BrowalliaUPC" size="18" isBold="true"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{questionaire_type}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents mode="Opaque" style="Crosstab_CT"/>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<columnGroup name="parent_question_id" height="140" totalPosition="Start">
					<bucket class="java.lang.Long">
						<bucketExpression><![CDATA[$F{parent_question_id}]]></bucketExpression>
					</bucket>
					<crosstabColumnHeader>
						<cellContents mode="Opaque" style="Crosstab_CH">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<textField isStretchWithOverflow="true" isBlankWhenNull="true">
								<reportElement x="0" y="0" width="40" height="140" uuid="c19bff93-c9ce-4aee-a81b-574447d40034"/>
								<box bottomPadding="3"/>
								<textElement verticalAlignment="Top" rotation="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<textFieldExpression><![CDATA[$V{question_name}]]></textFieldExpression>
							</textField>
						</cellContents>
					</crosstabColumnHeader>
					<crosstabTotalColumnHeader>
						<cellContents mode="Opaque" style="Crosstab_CG">
							<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.FreeLayout"/>
							<staticText>
								<reportElement x="0" y="0" width="35" height="140" uuid="0bf791c0-e124-445d-997c-7a216c9d1350"/>
								<box bottomPadding="3">
									<pen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Left" verticalAlignment="Middle" rotation="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<text><![CDATA[จำนวนฟอร์ม]]></text>
							</staticText>
							<staticText>
								<reportElement key="" x="35" y="0" width="35" height="140" uuid="a354d203-c6e6-4686-8484-e39b6af062b5"/>
								<box bottomPadding="3">
									<topPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<leftPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<bottomPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
									<rightPen lineWidth="0.5" lineStyle="Solid" lineColor="#000000"/>
								</box>
								<textElement textAlignment="Left" verticalAlignment="Middle" rotation="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<text><![CDATA[จำนวนร้าน]]></text>
							</staticText>
							<staticText>
								<reportElement x="70" y="0" width="35" height="140" uuid="bdbab9f1-a5ad-4ad7-b745-140feeea59b8"/>
								<box bottomPadding="3">
									<pen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Left" verticalAlignment="Middle" rotation="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<text><![CDATA[รับทราบแล้ว]]></text>
							</staticText>
							<staticText>
								<reportElement x="105" y="0" width="35" height="140" uuid="1a73884f-0d0d-4356-8fc0-ab114ecf07a2"/>
								<box bottomPadding="3">
									<pen lineWidth="0.5"/>
								</box>
								<textElement textAlignment="Left" verticalAlignment="Middle" rotation="Left">
									<font fontName="BrowalliaUPC" size="14"/>
								</textElement>
								<text><![CDATA[คะแนนรวม]]></text>
							</staticText>
						</cellContents>
					</crosstabTotalColumnHeader>
				</columnGroup>
				<measure name="questionaire_type" class="java.lang.String">
					<measureExpression><![CDATA[$F{questionaire_type}]]></measureExpression>
				</measure>
				<measure name="question_name" class="java.lang.String">
					<measureExpression><![CDATA[$F{question_name}]]></measureExpression>
				</measure>
				<measure name="name_assessor" class="java.lang.String">
					<measureExpression><![CDATA[$F{name_assessor}]]></measureExpression>
				</measure>
				<measure name="position_assor" class="java.lang.String">
					<measureExpression><![CDATA[$F{position_assor}]]></measureExpression>
				</measure>
				<measure name="name_employee" class="java.lang.String">
					<measureExpression><![CDATA[$F{name_employee}]]></measureExpression>
				</measure>
				<measure name="num_cus" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{num_cus}]]></measureExpression>
				</measure>
				<measure name="num_from" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{num_from}]]></measureExpression>
				</measure>
				<measure name="know" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{know}]]></measureExpression>
				</measure>
				<measure name="percent" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{percent}]]></measureExpression>
				</measure>
				<measure name="sum_num_from" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{sum_num_from}]]></measureExpression>
				</measure>
				<measure name="sum_num_cus" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{sum_num_cus}]]></measureExpression>
				</measure>
				<measure name="sum_know" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{sum_know}]]></measureExpression>
				</measure>
				<measure name="percent_by_total" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{percent_by_total}]]></measureExpression>
				</measure>
				<measure name="n_form" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{n_form}]]></measureExpression>
				</measure>
				<measure name="n_cus" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{n_cus}]]></measureExpression>
				</measure>
				<measure name="n_know" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{n_know}]]></measureExpression>
				</measure>
				<measure name="percent_all" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{percent_all}]]></measureExpression>
				</measure>
				<measure name="percent_score" class="java.math.BigDecimal">
					<measureExpression><![CDATA[$F{percent_score}]]></measureExpression>
				</measure>
				<crosstabCell width="40" height="20">
					<cellContents mode="Opaque" style="Crosstab_CD">
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="40" height="20" uuid="6189482f-1df6-461b-8dea-736cc959234b"/>
							<box rightPadding="3"/>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[($V{question_name}== null) ? null:$V{percent}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="140" height="20" columnTotalGroup="parent_question_id">
					<cellContents mode="Opaque" style="Crosstab_CG">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.HorizontalRowLayout"/>
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="35" height="20" uuid="09ab4295-ac92-40cf-93f7-b468fedccac2"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{num_from}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="35" y="0" width="35" height="20" uuid="17090a8d-1947-4fae-83a2-1081ad03dadb"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{num_cus}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="70" y="0" width="35" height="20" uuid="b15c2641-622c-4033-be3c-b4f798c70ddb"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{know}]]></textFieldExpression>
						</textField>
						<textField pattern="#,##0.00" isBlankWhenNull="true">
							<reportElement x="105" y="0" width="35" height="20" uuid="46618afe-f49f-4ad1-8d8f-448b957d6829"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{percent_score}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="0" height="20" columnTotalGroup="questionaire_type_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="40" height="20" rowTotalGroup="questionaire_date">
					<cellContents mode="Opaque" style="Crosstab_CG">
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="40" height="20" uuid="de4d3ba6-6bed-4145-b6d6-9cefdd8658ac"/>
							<box rightPadding="3"/>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[($V{question_name}== null) ? null:$V{percent_by_total}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="140" height="20" rowTotalGroup="questionaire_date" columnTotalGroup="parent_question_id">
					<cellContents mode="Opaque" style="Crosstab_CG">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.HorizontalRowLayout"/>
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="35" height="20" uuid="929fafc9-4b3d-43e0-9056-afe3d68d15b3"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{sum_num_from}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="35" y="0" width="35" height="20" uuid="90ed0beb-f226-4810-b8c3-e52bd7e14dc1"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{sum_num_cus}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="70" y="0" width="35" height="20" uuid="3f76563f-2dbb-4f1c-a82c-2344ebccd06e"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{sum_know}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="105" y="0" width="35" height="20" uuid="1f2c8ad0-a2ca-4b72-a507-890590495766"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[""]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="0" height="20" rowTotalGroup="questionaire_date" columnTotalGroup="questionaire_type_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="40" height="20" rowTotalGroup="position_employee">
					<cellContents mode="Opaque" style="Crosstab_CT">
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="40" height="20" uuid="fbb71ec4-4104-4292-b31c-92508f2960bb"/>
							<box rightPadding="3"/>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[($V{question_name}== null )? null :$V{percent_all}]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="140" height="20" rowTotalGroup="position_employee" columnTotalGroup="parent_question_id">
					<cellContents mode="Opaque" style="Crosstab_CT">
						<property name="com.jaspersoft.studio.layout" value="com.jaspersoft.studio.editor.layout.HorizontalRowLayout"/>
						<textField isBlankWhenNull="true">
							<reportElement x="0" y="0" width="35" height="20" uuid="1ebfb37b-6700-4fb5-863c-39fe7917ca12"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{n_form}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="35" y="0" width="35" height="20" uuid="0c113a5d-dfba-49fb-922d-d30066e47abd"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{n_cus}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="70" y="0" width="35" height="20" uuid="6ff48386-fa52-4ac6-b751-ca2b8535eb25"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[$V{n_know}]]></textFieldExpression>
						</textField>
						<textField isBlankWhenNull="true">
							<reportElement x="105" y="0" width="35" height="20" uuid="d833b06c-7537-42c4-91c3-2efdc0487657"/>
							<box rightPadding="3">
								<pen lineWidth="0.5"/>
							</box>
							<textElement textAlignment="Right">
								<font fontName="BrowalliaUPC" size="14"/>
							</textElement>
							<textFieldExpression><![CDATA[""]]></textFieldExpression>
						</textField>
					</cellContents>
				</crosstabCell>
				<crosstabCell width="0" height="20" rowTotalGroup="position_employee" columnTotalGroup="questionaire_type_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="40" height="0" rowTotalGroup="job_function_id">
					<cellContents mode="Opaque" style="Crosstab_CG"/>
				</crosstabCell>
				<crosstabCell width="140" height="0" rowTotalGroup="job_function_id" columnTotalGroup="parent_question_id">
					<cellContents mode="Opaque" style="Crosstab_CG"/>
				</crosstabCell>
				<crosstabCell width="0" height="0" rowTotalGroup="job_function_id" columnTotalGroup="questionaire_type_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="40" height="0" rowTotalGroup="assessor_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="140" height="0" rowTotalGroup="assessor_id" columnTotalGroup="parent_question_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
				<crosstabCell width="0" height="0" rowTotalGroup="assessor_id" columnTotalGroup="questionaire_type_id">
					<cellContents mode="Opaque" style="Crosstab_CT"/>
				</crosstabCell>
			</crosstab>
		</band>
	</columnHeader>
</jasperReport>
